<!-- update.component.html -->


  <!-- Settings Card (stays separate) -->
  <nb-card>
    <nb-card-header>Settings</nb-card-header>
    <nb-card-body>
      <app-edit></app-edit>
    </nb-card-body>
  </nb-card>

  <!-- Flex container for the update cards -->
  <div class="cards-container">

    <!-- Current Version Info Card -->
    <nb-card class="card-item">
      <nb-card-header>
        Current Version: {{ (info$ | async)?.version }}
      </nb-card-header>
    </nb-card>

    <nb-card class="card-item" style="position: relative;">
      <nb-card-header>
        Update Firmware
        <span *ngIf="firmwareUpdateProgress != null && firmwareUpdateProgress > 0">
          {{ firmwareUpdateProgress }}%
        </span>
      </nb-card-header>
      <nb-card-body>
        <!-- Hidden file input -->
        <input type="file"
               #firmwareInput
               hidden
               (change)="onFirmwareFileSelected($event)"
               accept=".bin">
        <!-- Action buttons container -->
        <div class="action-buttons">
          <!-- Custom "Browse" button -->
          <button nbButton [status]="'primary'" size="small" (click)="firmwareInput.click()">
            <nb-icon icon="folder-outline" pack="eva"></nb-icon>&nbsp;
            Browse
          </button>
          <!-- "Upload" button -->
          <button nbButton [status]="'primary'" size="small" [nbSpinner]="isFirmwareUploading" (click)="uploadFirmwareFile()">
            <nb-icon icon="upload-outline" pack="eva"></nb-icon>&nbsp;
            Flash
          </button>
        </div>
        <small *ngIf="selectedFirmwareFile">Selected: {{ selectedFirmwareFile.name }}</small>
      </nb-card-body>
    </nb-card>

    <nb-card class="card-item" style="position: relative;">
      <nb-card-header>
        Update Website
        <span *ngIf="websiteUpdateProgress != null && websiteUpdateProgress > 0">
          {{ websiteUpdateProgress }}%
        </span>
      </nb-card-header>
      <nb-card-body>
        <!-- Hidden file input -->
        <input type="file"
               #websiteInput
               hidden
               (change)="onWebsiteFileSelected($event)"
               accept=".bin">
        <!-- Action buttons container -->
        <div class="action-buttons">
          <!-- Custom "Browse" button -->
          <button nbButton [status]="'primary'" size="small" (click)="websiteInput.click()">
            <nb-icon icon="folder-outline" pack="eva"></nb-icon>&nbsp;
            Browse
          </button>
          <!-- "Upload" button -->
          <button nbButton [status]="'primary'" size="small" [nbSpinner]="isWebsiteUploading" (click)="uploadWebsiteFile()">
            <nb-icon icon="upload-outline" pack="eva"></nb-icon>&nbsp;
            Flash
          </button>
        </div>
        <small *ngIf="selectedWebsiteFile">Selected: {{ selectedWebsiteFile.name }}</small>
      </nb-card-body>
    </nb-card>
  </div>

  <!-- Overlay for progress indication -->
  <div *ngIf="isWebsiteUploading" class="upload-overlay">
    <div class="progress-box">
      <!-- Using Nebular's progress bar -->
      <nb-progress-bar [value]="websiteUpdateProgress" status="primary"></nb-progress-bar>
      <div class="progress-text">{{ websiteUpdateProgress }}%</div>
    </div>
  </div>

  <!-- Overlay for progress indication -->
  <div *ngIf="isFirmwareUploading" class="upload-overlay">
    <div class="progress-box">
      <nb-progress-bar [value]="firmwareUpdateProgress" status="primary"></nb-progress-bar>
      <div class="progress-text">{{ firmwareUpdateProgress }}%</div>
    </div>
  </div>
